<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinNice - Your Friendly Portfolio Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #171e53 0%, #a28add 50%, #fc4085 75%, #ffd03b 100%);
        }
        .card-gradient {
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen font-sans">
<div class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Header -->
    <div class="text-center mb-8">
        <h1 class="text-5xl font-bold text-white mb-2 drop-shadow-lg">üí∞ FinNice</h1>
        <p class="text-white/90 text-lg">Your friendly portfolio companion</p>
    </div>

    <!-- Main Menu -->
    <div id="mainMenu" class="card-gradient rounded-2xl shadow-xl p-8 mb-6 border border-white/20">
        <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">What would you like to do today? üòä</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <button onclick="showSection('browsing')" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-4 px-6 rounded-xl transition duration-300 transform hover:scale-105 shadow-lg">
                üëÄ Just Browsing
            </button>
            <button onclick="showSection('addStock')" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-4 px-6 rounded-xl transition duration-300 transform hover:scale-105 shadow-lg">
                ‚ûï Add Stock
            </button>
            <button onclick="showSection('sellStock')" class="bg-gradient-to-r from-pink-500 to-pink-600 hover:from-pink-600 hover:to-pink-700 text-white font-semibold py-4 px-6 rounded-xl transition duration-300 transform hover:scale-105 shadow-lg">
                üí∞ Sell Stock
            </button>
            <button onclick="showSection('performance')" class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-semibold py-4 px-6 rounded-xl transition duration-300 transform hover:scale-105 shadow-lg">
                üìä See Performance
            </button>
        </div>
    </div>

    <!-- Back Button (hidden initially) -->
    <button id="backButton" onclick="showMainMenu()" class="hidden mb-4 bg-white/20 hover:bg-white/30 text-white px-6 py-3 rounded-lg transition duration-300 backdrop-blur-sm border border-white/30">
        ‚Üê Back to Menu
    </button>

    <!-- Browsing Section -->
    <div id="browsingSection" class="hidden">
        <!-- Portfolio Selection -->
        <div class="card-gradient rounded-2xl shadow-xl p-6 mb-6 border border-white/20">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-gray-800">üìÅ Your Portfolios</h3>
                <button onclick="createNewPortfolio()" class="bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-white px-4 py-2 rounded-lg transition duration-300 shadow-md">
                    ‚ûï New Portfolio
                </button>
            </div>
            <select id="portfolioSelect" onchange="loadPortfolioData()" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-4">
                <option value="">Select a portfolio...</option>
            </select>
        </div>

        <!-- Portfolio Overview -->
        <div id="portfolioOverview" class="hidden card-gradient rounded-2xl shadow-xl p-6 mb-6 border border-white/20">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">üíº Portfolio Overview</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="bg-gradient-to-r from-green-400/20 to-green-500/20 p-4 rounded-lg text-center border border-green-300/30">
                    <p class="text-green-700 font-semibold">Total Balance</p>
                    <p id="totalBalance" class="text-2xl font-bold text-green-800">$0.00</p>
                </div>
                <div class="bg-gradient-to-r from-blue-400/20 to-blue-500/20 p-4 rounded-lg text-center border border-blue-300/30">
                    <p class="text-blue-700 font-semibold">Total Invested</p>
                    <p id="totalInvested" class="text-2xl font-bold text-blue-800">$0.00</p>
                </div>
                <div class="bg-gradient-to-r from-purple-400/20 to-purple-500/20 p-4 rounded-lg text-center border border-purple-300/30">
                    <p class="text-purple-700 font-semibold">Total Gain</p>
                    <p id="totalGain" class="text-2xl font-bold text-purple-800">$0.00</p>
                </div>
            </div>

            <h4 class="text-lg font-semibold text-gray-800 mb-3">üìã Your Stocks</h4>
            <div id="stocksList" class="space-y-3">
                <!-- Stocks will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Add Stock Section -->
    <div id="addStockSection" class="hidden">
        <div class="card-gradient rounded-2xl shadow-xl p-6 border border-white/20">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">‚ûï Add New Stock</h3>
            <form onsubmit="addStock(event)" class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Portfolio</label>
                    <select id="addStockPortfolio" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Select portfolio...</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Asset Code</label>
                    <input type="text" id="stockSymbol" placeholder="e.g., AAPL" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Quantity</label>
                    <input type="number" id="shareCount" placeholder="e.g., 10" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Buy Price</label>
                    <input type="number" id="sharePrice" step="0.01" placeholder="e.g., 150.00" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Exchange</label>
                    <select id="exchange" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="NYSE">NYSE</option>
                        <option value="NASDAQ">NASDAQ</option>
                        <option value="LSE">LSE</option>
                        <option value="TSX">TSX</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Trade Date (optional)</label>
                    <input type="date" id="purchaseDate" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300 shadow-lg">
                    Add to Portfolio
                </button>
            </form>
            <div id="addStockMessage" class="hidden mt-4 p-3 bg-green-100 text-green-700 rounded-lg border border-green-300"></div>
        </div>
    </div>

    <!-- Sell Stock Section -->
    <div id="sellStockSection" class="hidden">
        <div class="card-gradient rounded-2xl shadow-xl p-6 border border-white/20">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">üí∞ Sell Stock</h3>
            <form onsubmit="sellStock(event)" class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Select Stock</label>
                    <select id="sellStockSelect" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
                        <option value="">Choose a stock to sell</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">Quantity to Sell</label>
                    <input type="number" id="sellShareCount" placeholder="e.g., 5" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent">
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-pink-500 to-pink-600 hover:from-pink-600 hover:to-pink-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300 shadow-lg">
                    Sell Shares
                </button>
            </form>
            <div id="sellStockMessage" class="hidden mt-4 p-3 bg-pink-100 text-pink-700 rounded-lg border border-pink-300"></div>
        </div>
    </div>

    <!-- Performance Section -->
    <div id="performanceSection" class="hidden">
        <div class="card-gradient rounded-2xl shadow-xl p-6 border border-white/20">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">üìä Performance Analysis</h3>

            <!-- Performance Options -->
            <div class="mb-6">
                <div class="flex flex-wrap gap-3 mb-4">
                    <button onclick="showMarketPerformance()" id="marketBtn" class="bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white px-4 py-2 rounded-lg transition duration-300 shadow-md">
                        üìà Market Overview
                    </button>
                    <button onclick="showStockPerformance()" id="stockBtn" class="bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white px-4 py-2 rounded-lg transition duration-300 shadow-md">
                        üìä Single Stock
                    </button>
                </div>

                <!-- Stock Selection (hidden initially) -->
                <div id="stockSelection" class="hidden mb-4">
                    <select id="performanceStockSelect" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        <option value="">Select a stock...</option>
                    </select>
                </div>
            </div>

            <div class="mb-6">
                <canvas id="performanceChart" width="400" height="200"></canvas>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-gradient-to-r from-green-400/20 to-green-500/20 p-4 rounded-lg border border-green-300/30">
                    <h4 class="font-semibold text-green-700 mb-2">Best Performer</h4>
                    <p id="bestPerformer" class="text-lg font-bold">-</p>
                    <p id="bestPerformance" class="text-green-600">-</p>
                </div>
                <div class="bg-gradient-to-r from-red-400/20 to-red-500/20 p-4 rounded-lg border border-red-300/30">
                    <h4 class="font-semibold text-red-700 mb-2">Needs Attention</h4>
                    <p id="worstPerformer" class="text-lg font-bold">-</p>
                    <p id="worstPerformance" class="text-red-600">-</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let performanceChart = null;
    let currentPortfolioId = null;
    let portfolios = [];
    let portfolioItems = [];

    // API Base URL - Update this to match your backend
    const API_BASE = 'http://localhost:8080/api'; // Update this URL

    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
        loadPortfolios();
    });

    function showSection(sectionName) {
        // Hide main menu and show back button
        document.getElementById('mainMenu').classList.add('hidden');
        document.getElementById('backButton').classList.remove('hidden');

        // Hide all sections
        const sections = ['browsingSection', 'addStockSection', 'sellStockSection', 'performanceSection'];
        sections.forEach(section => {
            document.getElementById(section).classList.add('hidden');
        });

        // Show selected section
        document.getElementById(sectionName + 'Section').classList.remove('hidden');

        // Load data for specific sections
        if (sectionName === 'browsing') {
            loadPortfolios();
        } else if (sectionName === 'addStock') {
            loadPortfoliosForAddStock();
        } else if (sectionName === 'sellStock') {
            loadStocksForSelling();
        } else if (sectionName === 'performance') {
            showMarketPerformance();
            loadStocksForPerformance();
        }
    }

    function showMainMenu() {
        // Show main menu and hide back button
        document.getElementById('mainMenu').classList.remove('hidden');
        document.getElementById('backButton').classList.add('hidden');

        // Hide all sections
        const sections = ['browsingSection', 'addStockSection', 'sellStockSection', 'performanceSection'];
        sections.forEach(section => {
            document.getElementById(section).classList.add('hidden');
        });
    }

    // Portfolio Management
    async function loadPortfolios() {
        try {
            const response = await fetch(`${API_BASE}/portfolios`);
            if (response.ok) {
                portfolios = await response.json();
                updatePortfolioSelect();
            } else {
                // Demo data if API not available
                portfolios = [
                    { id: 1, name: "My Main Portfolio" },
                    { id: 2, name: "Tech Stocks" }
                ];
                updatePortfolioSelect();
            }
        } catch (error) {
            console.log('API not available, using demo data');
            portfolios = [
                { id: 1, name: "My Main Portfolio" },
                { id: 2, name: "Tech Stocks" }
            ];
            updatePortfolioSelect();
        }
    }

    function updatePortfolioSelect() {
        const select = document.getElementById('portfolioSelect');
        select.innerHTML = '<option value="">Select a portfolio...</option>';
        portfolios.forEach(portfolio => {
            const option = document.createElement('option');
            option.value = portfolio.id;
            option.textContent = portfolio.name;
            select.appendChild(option);
        });
    }

    async function createNewPortfolio() {
        const name = prompt('Enter portfolio name:');
        if (name) {
            try {
                const response = await fetch(`${API_BASE}/portfolios`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: `name=${encodeURIComponent(name)}`
                });
                if (response.ok) {
                    loadPortfolios();
                }
            } catch (error) {
                // Demo mode
                portfolios.push({ id: Date.now(), name: name });
                updatePortfolioSelect();
            }
        }
    }

    async function loadPortfolioData() {
        const portfolioId = document.getElementById('portfolioSelect').value;
        if (!portfolioId) {
            document.getElementById('portfolioOverview').classList.add('hidden');
            return;
        }

        currentPortfolioId = portfolioId;
        document.getElementById('portfolioOverview').classList.remove('hidden');

        try {
            const response = await fetch(`${API_BASE}/portfolios/${portfolioId}/items`);
            if (response.ok) {
                portfolioItems = await response.json();
                displayPortfolioItems();
            } else {
                // Demo data
                portfolioItems = [
                    { id: 1, assetCode: 'AAPL', quantity: 10, buyPrice: 150.00, exchange: 'NASDAQ' },
                    { id: 2, assetCode: 'GOOGL', quantity: 5, buyPrice: 2500.00, exchange: 'NASDAQ' },
                    { id: 3, assetCode: 'TSLA', quantity: 8, buyPrice: 800.00, exchange: 'NASDAQ' }
                ];
                displayPortfolioItems();
            }
        } catch (error) {
            // Demo data
            portfolioItems = [
                { id: 1, assetCode: 'AAPL', quantity: 10, buyPrice: 150.00, exchange: 'NASDAQ' },
                { id: 2, assetCode: 'GOOGL', quantity: 5, buyPrice: 2500.00, exchange: 'NASDAQ' },
                { id: 3, assetCode: 'TSLA', quantity: 8, buyPrice: 800.00, exchange: 'NASDAQ' }
            ];
            displayPortfolioItems();
        }
    }

    function displayPortfolioItems() {
        const stocksList = document.getElementById('stocksList');
        stocksList.innerHTML = '';

        let totalInvested = 0;
        let totalBalance = 0;

        portfolioItems.forEach(item => {
            const invested = item.quantity * item.buyPrice;
            const currentValue = invested * (1 + (Math.random() * 0.4 - 0.2)); // Demo current value
            const gain = currentValue - invested;

            totalInvested += invested;
            totalBalance += currentValue;

            const stockDiv = document.createElement('div');
            stockDiv.className = 'flex justify-between items-center p-3 bg-white/50 rounded-lg border border-white/30';
            stockDiv.innerHTML = `
                <div>
                    <span class="font-semibold">${item.assetCode}</span>
                    <span class="text-gray-600 ml-2">${item.quantity} shares</span>
                    <span class="text-gray-500 ml-2 text-sm">(${item.exchange})</span>
                </div>
                <div class="text-right">
                    <div class="font-semibold">$${currentValue.toFixed(2)}</div>
                    <div class="${gain >= 0 ? 'text-green-600' : 'text-red-600'} text-sm">
                        ${gain >= 0 ? '+' : ''}$${gain.toFixed(2)}
                    </div>
                </div>
                <div class="flex gap-2 ml-4">
                    <button onclick="editStock(${item.id})" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition duration-300">
                        ‚úèÔ∏è Edit
                    </button>
                    <button onclick="removeStock(${item.id})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition duration-300">
                        üóëÔ∏è Remove
                    </button>
                </div>
            `;
            stocksList.appendChild(stockDiv);
        });

        const totalGain = totalBalance - totalInvested;
        document.getElementById('totalBalance').textContent = `$${totalBalance.toFixed(2)}`;
        document.getElementById('totalInvested').textContent = `$${totalInvested.toFixed(2)}`;
        document.getElementById('totalGain').textContent = `${totalGain >= 0 ? '+' : ''}$${totalGain.toFixed(2)}`;
    }

    async function editStock(itemId) {
        const newQuantity = prompt('Enter new quantity:');
        if (newQuantity) {
            try {
                const response = await fetch(`${API_BASE}/items/${itemId}/quantity`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: `quantity=${newQuantity}`
                });
                if (response.ok) {
                    loadPortfolioData();
                }
            } catch (error) {
                // Demo mode
                const item = portfolioItems.find(i => i.id == itemId);
                if (item) item.quantity = parseInt(newQuantity);
                displayPortfolioItems();
            }
        }
    }

    async function removeStock(itemId) {
        if (confirm('Are you sure you want to remove this stock?')) {
            try {
                const response = await fetch(`${API_BASE}/items/${itemId}`, {
                    method: 'DELETE'
                });
                if (response.ok) {
                    loadPortfolioData();
                }
            } catch (error) {
                // Demo mode
                portfolioItems = portfolioItems.filter(i => i.id != itemId);
                displayPortfolioItems();
            }
        }
    }

    // Add Stock
    function loadPortfoliosForAddStock() {
        const select = document.getElementById('addStockPortfolio');
        select.innerHTML = '<option value="">Select portfolio...</option>';
        portfolios.forEach(portfolio => {
            const option = document.createElement('option');
            option.value = portfolio.id;
            option.textContent = portfolio.name;
            select.appendChild(option);
        });
    }

    async function addStock(event) {
        event.preventDefault();
        const portfolioId = document.getElementById('addStockPortfolio').value;
        const assetCode = document.getElementById('stockSymbol').value;
        const quantity = document.getElementById('shareCount').value;
        const buyPrice = document.getElementById('sharePrice').value;
        const exchange = document.getElementById('exchange').value;
        const tradeDate = document.getElementById('purchaseDate').value;

        if (portfolioId && assetCode && quantity && buyPrice && exchange) {
            try {
                const params = new URLSearchParams({
                    assetCode,
                    quantity,
                    buyPrice,
                    exchange
                });
                if (tradeDate) params.append('tradeDate', tradeDate);

                const response = await fetch(`${API_BASE}/portfolios/${portfolioId}/items`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: params.toString()
                });

                if (response.ok) {
                    const message = document.getElementById('addStockMessage');
                    message.textContent = `Successfully added ${quantity} shares of ${assetCode.toUpperCase()}!`;
                    message.classList.remove('hidden');

                    // Clear form
                    document.getElementById('addStockPortfolio').value = '';
                    document.getElementById('stockSymbol').value = '';
                    document.getElementById('shareCount').value = '';
                    document.getElementById('sharePrice').value = '';
                    document.getElementById('exchange').value = 'NYSE';
                    document.getElementById('purchaseDate').value = '';

                    setTimeout(() => message.classList.add('hidden'), 3000);
                }
            } catch (error) {
                // Demo mode
                const message = document.getElementById('addStockMessage');
                message.textContent = `Demo: Added ${quantity} shares of ${assetCode.toUpperCase()}!`;
                message.classList.remove('hidden');
                setTimeout(() => message.classList.add('hidden'), 3000);
            }
        }
    }

    // Sell Stock
    function loadStocksForSelling() {
        const select = document.getElementById('sellStockSelect');
        select.innerHTML = '<option value="">Choose a stock to sell</option>';
        portfolioItems.forEach(item => {
            const option = document.createElement('option');
            option.value = item.id;
            option.textContent = `${item.assetCode} - ${item.quantity} shares`;
            select.appendChild(option);
        });
    }

    async function sellStock(event) {
        event.preventDefault();
        const itemId = document.getElementById('sellStockSelect').value;
        const quantity = document.getElementById('sellShareCount').value;

        if (itemId && quantity) {
            try {
                const response = await fetch(`${API_BASE}/items/${itemId}/quantity`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: `quantity=${quantity}`
                });

                if (response.ok) {
                    const message = document.getElementById('sellStockMessage');
                    message.textContent = `Successfully updated quantity to ${quantity} shares!`;
                    message.classList.remove('hidden');

                    document.getElementById('sellStockSelect').value = '';
                    document.getElementById('sellShareCount').value = '';

                    setTimeout(() => message.classList.add('hidden'), 3000);
                }
            } catch (error) {
                const message = document.getElementById('sellStockMessage');
                message.textContent = `Demo: Updated quantity to ${quantity} shares!`;
                message.classList.remove('hidden');
                setTimeout(() => message.classList.add('hidden'), 3000);
            }
        }
    }

    // Performance
    function loadStocksForPerformance() {
        const select = document.getElementById('performanceStockSelect');
        select.innerHTML = '<option value="">Select a stock...</option>';
        portfolioItems.forEach(item => {
            const option = document.createElement('option');
            option.value = item.assetCode;
            option.textContent = item.assetCode;
            select.appendChild(option);
        });
    }

    function showMarketPerformance() {
        document.getElementById('stockSelection').classList.add('hidden');
        document.getElementById('marketBtn').classList.add('bg-gradient-to-r', 'from-blue-600', 'to-blue-700');
        document.getElementById('stockBtn').classList.remove('bg-gradient-to-r', 'from-purple-600', 'to-purple-700');
        initPerformanceChart('market');
    }

    function showStockPerformance() {
        document.getElementById('stockSelection').classList.remove('hidden');
        document.getElementById('stockBtn').classList.add('bg-gradient-to-r', 'from-purple-600', 'to-purple-700');
        document.getElementById('marketBtn').classList.remove('bg-gradient-to-r', 'from-blue-600', 'to-blue-700');

        const selectedStock = document.getElementById('performanceStockSelect').value;
        if (selectedStock) {
            initPerformanceChart('stock', selectedStock);
        }
    }

    function initPerformanceChart(type = 'market', stock = null) {
        const ctx = document.getElementById('performanceChart').getContext('2d');

        if (performanceChart) {
            performanceChart.destroy();
        }

        let data, label, color;
        if (type === 'market') {
            data = [10000, 10500, 10200, 11000, 11800, 12450];
            label = 'Portfolio Value';
            color = 'rgb(59, 130, 246)';
        } else {
            data = [150, 155, 148, 165, 172, 175];
            label = `${stock} Price`;
            color = 'rgb(147, 51, 234)';
        }

        performanceChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    label: label,
                    data: data,
                    borderColor: color,
                    backgroundColor: color.replace('rgb', 'rgba').replace(')', ', 0.1)'),
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        ticks: {
                            callback: function(value) {
                                return '$' + value.toLocaleString();
                            }
                        }
                    }
                }
            }
        });

        // Update performance stats
        document.getElementById('bestPerformer').textContent = 'AAPL';
        document.getElementById('bestPerformance').textContent = '+16.67% gain';
        document.getElementById('worstPerformer').textContent = 'TSLA';
        document.getElementById('worstPerformance').textContent = '-2.33% loss';
    }
</script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'974a4c8734e548e4',t:'MTc1NjExNjYxOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
